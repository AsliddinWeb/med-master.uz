<!DOCTYPE html>
<html lang="uz" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <!-- Medical Auth SEO -->
    <title>
        {% block title %}
            {% if page_title %}{{ page_title }} | {% endif %}
            {% if site_settings.site_name %}{{ site_settings.site_name }}{% else %}Tibbiy Ta'lim Platformasi{% endif %}
        {% endblock %}
    </title>

    <meta name="description" content="{% block meta_description %}Professional tibbiy ta'lim platformasiga xush kelibsiz. Ro'yxatdan o'ting yoki tizimga kiring.{% endblock %}">
    <meta name="robots" content="noindex, nofollow">

    <!-- Medical Auth Favicons -->
    {% if site_settings.site_favicon %}
        <link rel="icon" type="image/x-icon" href="{{ site_settings.site_favicon.url }}">
    {% else %}
        {% load static %}
        <link rel="icon" type="image/x-icon" href="{% static 'images/favicon.ico' %}">
    {% endif %}

    <!-- Medical Auth Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', 'sans-serif'],
                    },
                    colors: {
                        'medical': {
                            50: '#f0fdfa',
                            100: '#ccfbf1',
                            500: '#14b8a6',
                            600: '#0d9488',
                            700: '#0f766e',
                            800: '#115e59',
                            900: '#134e4a',
                        }
                    }
                }
            }
        }
    </script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    {% block extra_css %}{% endblock %}
</head>

<body class="bg-gradient-to-br from-slate-50 via-cyan-50 to-teal-50 min-h-screen font-sans antialiased">

    <!-- Medical Auth Background Pattern -->
    <div class="fixed inset-0 overflow-hidden pointer-events-none">
        <!-- Medical Icons Background -->
        <div class="absolute top-20 left-20 text-teal-200 opacity-20 animate-pulse">
            <i class="fas fa-stethoscope text-8xl transform rotate-12"></i>
        </div>
        <div class="absolute top-40 right-32 text-cyan-200 opacity-15 animate-pulse" style="animation-delay: 1s;">
            <i class="fas fa-heartbeat text-6xl transform -rotate-12"></i>
        </div>
        <div class="absolute bottom-40 left-40 text-medical-200 opacity-20 animate-pulse" style="animation-delay: 2s;">
            <i class="fas fa-microscope text-7xl transform rotate-45"></i>
        </div>
        <div class="absolute bottom-20 right-20 text-blue-200 opacity-15 animate-pulse" style="animation-delay: 3s;">
            <i class="fas fa-user-md text-9xl transform -rotate-6"></i>
        </div>

        <!-- Medical Grid Pattern -->
        <div class="absolute inset-0 opacity-5" style="background-image: url('data:image/svg+xml,<svg width=\"60\" height=\"60\" viewBox=\"0 0 60 60\" xmlns=\"http://www.w3.org/2000/svg\"><g fill=\"none\" fill-rule=\"evenodd\"><g fill=\"%2314b8a6\" fill-opacity=\"0.1\"><circle cx=\"30\" cy=\"30\" r=\"4\"/></g></g></svg>')"></div>

        <!-- Medical Particles -->
        <div class="absolute inset-0">
            <div class="medical-particle absolute top-1/4 left-1/4 w-2 h-2 bg-teal-300 rounded-full opacity-30"></div>
            <div class="medical-particle absolute top-3/4 left-3/4 w-3 h-3 bg-cyan-300 rounded-full opacity-20" style="animation-delay: 2s;"></div>
            <div class="medical-particle absolute top-1/2 right-1/4 w-1 h-1 bg-medical-400 rounded-full opacity-40" style="animation-delay: 4s;"></div>
        </div>
    </div>

    <!-- Medical Auth Container -->
    <div class="relative min-h-screen flex items-center justify-center p-4">

        <!-- Medical Auth Card -->
        <div class="w-full max-w-md">

            <!-- Medical Logo/Header Section -->
            <div class="text-center mb-8">
                <!-- Medical Logo -->
                <div class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-medical-600 to-cyan-600 rounded-2xl shadow-2xl mb-6 medical-logo-pulse">
                    {% if site_settings.site_logo %}
                        <img src="{{ site_settings.site_logo.url }}" alt="Medical Logo" class="w-12 h-12 object-contain">
                    {% else %}
                        <i class="fas fa-user-md text-3xl text-white"></i>
                    {% endif %}
                </div>

                <!-- Medical Brand -->
                <h1 class="text-3xl font-bold text-gray-900 mb-2">
                    {% if site_settings.site_name %}
                        {{ site_settings.site_name }}
                    {% else %}
                        Tibbiy Ta'lim Platformasi
                    {% endif %}
                </h1>
                <p class="text-gray-600 font-medium">Professional Medical Education</p>
            </div>

            <!-- Medical Auth Form Card -->
            <div class="bg-white rounded-3xl shadow-2xl border border-medical-100 overflow-hidden medical-card-hover">

                <!-- Medical Auth Header -->
                <div class="bg-gradient-to-r from-medical-500 to-cyan-500 px-8 py-6 text-center">
                    <div class="w-16 h-16 bg-white bg-opacity-20 rounded-2xl flex items-center justify-center mx-auto mb-4 medical-icon-pulse">
                        {% block auth_icon %}
                            <i class="fas fa-shield-alt text-2xl text-white"></i>
                        {% endblock %}
                    </div>
                    <h2 class="text-2xl font-bold text-white mb-2">
                        {% block auth_title %}Tibbiy Autentifikatsiya{% endblock %}
                    </h2>
                    <p class="text-medical-100">
                        {% block auth_subtitle %}Xavfsiz tibbiy platformaga kirish{% endblock %}
                    </p>
                </div>

                <!-- Medical Messages -->
                {% if messages %}
                    <div class="px-8 pt-6">
                        {% for message in messages %}
                            <div class="medical-message medical-message-{{ message.tags }} mb-4 p-4 rounded-xl border-l-4 transition-all duration-300 transform">
                                <div class="flex items-start">
                                    <div class="w-6 h-6 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                                        {% if message.tags == 'success' %}
                                            <i class="fas fa-check-circle text-green-600"></i>
                                        {% elif message.tags == 'error' %}
                                            <i class="fas fa-exclamation-circle text-red-600"></i>
                                        {% elif message.tags == 'warning' %}
                                            <i class="fas fa-exclamation-triangle text-yellow-600"></i>
                                        {% else %}
                                            <i class="fas fa-info-circle text-blue-600"></i>
                                        {% endif %}
                                    </div>
                                    <div class="text-sm font-medium">{{ message|safe }}</div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}

                <!-- Medical Auth Form Content -->
                <div class="px-8 py-6">
                    {% block auth_form %}
                        <!-- Form content will be inserted here -->
                    {% endblock %}
                </div>

                <!-- Medical Auth Footer -->
                <div class="px-8 py-6 bg-gradient-to-r from-gray-50 to-medical-50 border-t border-gray-100">
                    {% block auth_footer %}
                        <!-- Footer content will be inserted here -->
                    {% endblock %}
                </div>
            </div>

            <!-- Medical Auth Links -->
            <div class="mt-8 text-center space-y-4">
                {% block auth_links %}
                    <div class="flex items-center justify-center space-x-6 text-sm">
                        <a href="{% url 'core:privacy_policy' %}" class="text-gray-600 hover:text-medical-600 transition-colors font-medium flex items-center">
                            <i class="fas fa-shield-alt mr-1"></i>
                            Maxfiylik
                        </a>
                        <a href="{% url 'core:terms_of_service' %}" class="text-gray-600 hover:text-medical-600 transition-colors font-medium flex items-center">
                            <i class="fas fa-file-contract mr-1"></i>
                            Shartlar
                        </a>
                        <a href="{% url 'core:contact' %}" class="text-gray-600 hover:text-medical-600 transition-colors font-medium flex items-center">
                            <i class="fas fa-envelope mr-1"></i>
                            Yordam
                        </a>
                    </div>
                {% endblock %}

                <!-- Back to Home -->
                <a href="{% url 'core:home' %}" class="inline-flex items-center text-medical-600 hover:text-medical-700 font-medium transition-colors">
                    <i class="fas fa-arrow-left mr-2"></i>
                    Bosh sahifaga qaytish
                </a>
            </div>
        </div>
    </div>

    <!-- Medical Auth Styles -->
    <style>
        /* Medical Auth Animations */
        @keyframes medicalFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }

        @keyframes medicalPulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.9; }
        }

        @keyframes medicalGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(20, 184, 166, 0.3); }
            50% { box-shadow: 0 0 30px rgba(20, 184, 166, 0.5); }
        }

        @keyframes medicalSlideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Medical Classes */
        .medical-logo-pulse {
            animation: medicalPulse 3s ease-in-out infinite;
        }

        .medical-icon-pulse {
            animation: medicalPulse 2s ease-in-out infinite;
        }

        .medical-card-hover {
            transition: all 0.3s ease;
            animation: medicalSlideIn 0.6s ease-out;
        }

        .medical-card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 50px -12px rgba(20, 184, 166, 0.25);
        }

        .medical-particle {
            animation: medicalFloat 6s ease-in-out infinite;
        }

        /* Medical Messages */
        .medical-message {
            animation: medicalSlideIn 0.3s ease-out;
        }

        .medical-message-success {
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
            border-color: #10b981;
        }

        .medical-message-error {
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            border-color: #ef4444;
        }

        .medical-message-warning {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-color: #f59e0b;
        }

        .medical-message-info {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            border-color: #3b82f6;
        }

        /* Medical Form Enhancements */
        .medical-input {
            transition: all 0.3s ease;
        }

        .medical-input:focus {
            animation: medicalGlow 2s ease-in-out infinite;
            transform: scale(1.02);
        }

        .medical-button {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .medical-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .medical-button:hover::before {
            left: 100%;
        }

        .medical-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(20, 184, 166, 0.4);
        }

        /* Medical Loading */
        .medical-loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #ffffff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Medical Responsive */
        @media (max-width: 640px) {
            .medical-card-hover {
                margin: 1rem;
                border-radius: 1.5rem;
            }
        }

        /* Medical Accessibility */
        .medical-focus:focus {
            outline: 2px solid #14b8a6;
            outline-offset: 2px;
        }

        /* Medical Dark Mode Support */
        @media (prefers-color-scheme: dark) {
            body {
                background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            }
        }
    </style>

    <!-- Medical Auth Scripts -->
    <script>
        // Medical Auth Enhancement
        class MedicalAuth {
            constructor() {
                this.init();
            }

            init() {
                this.enhanceFormInputs();
                this.addMedicalSounds();
                this.setupFormValidation();
                this.addKeyboardShortcuts();
            }

            enhanceFormInputs() {
                const inputs = document.querySelectorAll('input, textarea, select');
                inputs.forEach(input => {
                    input.classList.add('medical-input', 'medical-focus');

                    // Add medical focus effects
                    input.addEventListener('focus', () => {
                        this.playMedicalTone(523.25, 0.1);
                    });

                    input.addEventListener('blur', () => {
                        if (input.value) {
                            this.playMedicalTone(659.25, 0.1);
                        }
                    });
                });

                // Enhance buttons
                const buttons = document.querySelectorAll('button, .btn');
                buttons.forEach(button => {
                    button.classList.add('medical-button');

                    button.addEventListener('click', () => {
                        this.playMedicalTone(783.99, 0.2);
                    });
                });
            }

            addMedicalSounds() {
                try {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                } catch (error) {
                    this.audioContext = null;
                }
            }

            playMedicalTone(frequency, duration) {
                if (!this.audioContext) return;

                const oscillator = this.audioContext.createOscillator();
                const gainNode = this.audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(this.audioContext.destination);

                oscillator.frequency.setValueAtTime(frequency, this.audioContext.currentTime);
                oscillator.type = 'sine';

                gainNode.gain.setValueAtTime(0, this.audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.1, this.audioContext.currentTime + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + duration);

                oscillator.start();
                oscillator.stop(this.audioContext.currentTime + duration);
            }

            setupFormValidation() {
                const forms = document.querySelectorAll('form');
                forms.forEach(form => {
                    form.addEventListener('submit', (e) => {
                        const submitButton = form.querySelector('button[type="submit"]');
                        if (submitButton) {
                            this.setButtonLoading(submitButton, true);
                        }
                    });
                });
            }

            setButtonLoading(button, loading) {
                if (loading) {
                    button.disabled = true;
                    const originalText = button.innerHTML;
                    button.dataset.originalText = originalText;
                    button.innerHTML = `<span class="medical-loading mr-2"></span>Yuklanmoqda...`;
                } else {
                    button.disabled = false;
                    button.innerHTML = button.dataset.originalText || button.innerHTML;
                }
            }

            addKeyboardShortcuts() {
                document.addEventListener('keydown', (e) => {
                    // Alt + L for login focus
                    if (e.altKey && e.key === 'l') {
                        e.preventDefault();
                        const emailInput = document.querySelector('input[type="email"]');
                        if (emailInput) emailInput.focus();
                    }

                    // Alt + P for password focus
                    if (e.altKey && e.key === 'p') {
                        e.preventDefault();
                        const passwordInput = document.querySelector('input[type="password"]');
                        if (passwordInput) passwordInput.focus();
                    }
                });
            }
        }

        // Initialize Medical Auth
        document.addEventListener('DOMContentLoaded', () => {
            window.medicalAuth = new MedicalAuth();

            // Auto-hide messages
            const messages = document.querySelectorAll('.medical-message');
            messages.forEach(message => {
                setTimeout(() => {
                    message.style.opacity = '0';
                    message.style.transform = 'translateX(100%)';
                    setTimeout(() => message.remove(), 300);
                }, 5000);
            });
        });

        // Enable audio on first user interaction
        document.addEventListener('click', function enableAudio() {
            if (window.medicalAuth && window.medicalAuth.audioContext) {
                window.medicalAuth.audioContext.resume();
            }
            document.removeEventListener('click', enableAudio);
        }, { once: true });
    </script>

    {% block extra_js %}{% endblock %}
</body>
</html>